{"version":3,"sources":["../../../../src/components/Elements/FloatingContent/FloatingContent.js"],"names":["FloatingContent","props","trigger","isShown","onToggle","action","placement","offset","clickOutsideToToggle","widthAsTrigger","children","className","rest","triggerWrapperRef","contentWrapperRef","elementStyle","setElementStyle","mouseIsHovering","setMouseHover","classList","calcPopupPosition","current","nextStyle","clickOutsideHandler","target","contains","document","addEventListener","removeEventListener","onMouseEnter","onMouseLeave","actions","onClick","undefined","propTypes","PropTypes","node","isRequired","func","bool","oneOf","Placement","number","defaultProps","React","memo"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport Portal from '../_Portal/Portal';\nimport getElementAbsolutePosition from './getElementAbsolutePosition';\nimport { Placement, useWindowResize } from '../../../shared';\n\nimport './floating-content.scss';\n\n/**\n * A FloatingContent shows its own children components floating on a given trigger (possibly another React component).\n */\nconst FloatingContent = (props) => {\n  const {\n    trigger, isShown, onToggle, action, placement, offset, clickOutsideToToggle, widthAsTrigger,\n    children, className, ...rest\n  } = props;\n  const triggerWrapperRef = useRef(null);\n  const contentWrapperRef = useRef(null);\n  const [elementStyle, setElementStyle] = useState(null);\n  const [mouseIsHovering, setMouseHover] = useState(false);\n\n  const classList = classNames('bi bi-floater', {\n    'float-top-left': placement === 'top-left',\n    'float-top-center': placement === 'top-center',\n    'float-top-right': placement === 'top-right',\n    'float-left-center': placement === 'left-center',\n    'float-right-center': placement === 'right-center',\n    'float-bottom-left': placement === 'bottom-left',\n    'float-bottom-center': placement === 'bottom-center',\n    'float-bottom-right': placement === 'bottom-right',\n  }, className);\n\n  // Derives the component's position from the trigger's wrapper element then set it as elementStyle state.\n  const calcPopupPosition = () => {\n    if (isShown && triggerWrapperRef.current) {\n      const nextStyle = getElementAbsolutePosition(triggerWrapperRef.current, placement, offset, widthAsTrigger);\n\n      setElementStyle(nextStyle);\n    }\n  };\n\n  // handles the clicks outside the floating content (and outside the current trigger)\n  const clickOutsideHandler = ({ target }) => {\n    if (isShown\n      && (triggerWrapperRef.current && !triggerWrapperRef.current.contains(target))\n      && (contentWrapperRef.current && !contentWrapperRef.current.contains(target))) {\n      onToggle();\n    }\n  };\n\n  // recalculates the component's position when one of the following props change\n  useEffect(calcPopupPosition, [isShown, offset, placement, children]);\n\n  // recalculates the component's position on window resize\n  useWindowResize(calcPopupPosition);\n\n  // adds the click event listener when clickOutsideToToggle is true and when action is click\n  useEffect(() => {\n    if (triggerWrapperRef.current && contentWrapperRef.current && clickOutsideToToggle && action === 'click') {\n      document.addEventListener('click', clickOutsideHandler);\n    }\n\n    return () => {\n      document.removeEventListener('click', clickOutsideHandler);\n    };\n  }, [triggerWrapperRef.current, contentWrapperRef.current]);\n\n  /**\n   * onMouseEnter and onMouseLeave functions are both used to handle the hover action by toggling the\n   * mouseIsHovering state and firing the onToggle callback\n   */\n  const onMouseEnter = () => {\n    if (!mouseIsHovering) {\n      setMouseHover(true);\n      onToggle();\n    }\n  };\n\n  const onMouseLeave = () => {\n    if (mouseIsHovering) {\n      setMouseHover(false);\n      onToggle();\n    }\n  };\n\n  const actions = {\n    onClick: action === 'click' ? onToggle : undefined,\n    onMouseEnter: (action === 'hover') ? onMouseEnter : undefined,\n    onMouseLeave: action === 'hover' ? onMouseLeave : undefined,\n  };\n\n  return (\n    <>\n      {/* To easily access the trigger's position we wrap it within a referenced span */}\n      <span className=\"bi bi-float-trigger\" ref={triggerWrapperRef} role=\"complementary\" {...actions}>\n        {trigger}\n      </span>\n      {!isShown ? null : (\n        <Portal id=\"bi-floats\">\n          {/* The floating content is shown within a Portal to avoid layout glitches */}\n          <div {...rest} className={classList} style={elementStyle} ref={contentWrapperRef}>\n            {children}\n          </div>\n        </Portal>\n      )}\n    </>\n  );\n};\n\nFloatingContent.propTypes = {\n  /**\n   * Defines the React node to apply the floating content to\n   */\n  trigger: PropTypes.node.isRequired,\n  /**\n   * Defines the callback to be performed each time the event defined by the `action` prop fires,\n   * by default a `click` event\n   */\n  onToggle: PropTypes.func.isRequired,\n  /**\n   * Defines whether the floating content is shown or not\n   */\n  isShown: PropTypes.bool,\n  /**\n   * Defines when to fire the onToggle callback, it can be `click` or `hover`\n   */\n  action: PropTypes.oneOf(['click', 'hover']),\n  /**\n   * If the `action` prop is set to `click`, it's possible to define if the `onToggle` callback should be performed\n   * when clicking outside of the trigger\n   */\n  clickOutsideToToggle: PropTypes.bool,\n  /**\n   * Defines the popup placement\n   */\n  placement: Placement,\n  /**\n   * Defines a number in pixel to possibly separate the popup from the trigger\n   */\n  offset: PropTypes.number,\n  /**\n   * Defines if the floating content should have the same width of its trigger\n   */\n  widthAsTrigger: PropTypes.bool,\n};\n\nFloatingContent.defaultProps = {\n  isShown: false,\n  action: 'click',\n  clickOutsideToToggle: true,\n  placement: 'top-center',\n  offset: 0,\n  widthAsTrigger: false,\n};\n\nexport default React.memo(FloatingContent);\n"],"file":"FloatingContent.js"}